<!DOCTYPE html>
<html>
<head>
    <title>AirSense - Weather & Pollen Tracker</title>
    <link rel="stylesheet" href="/static/core/css/home.css">
</head>
<body>
    <div class="container">
        <div class="nav-links">
            {% if user.is_authenticated %}
                <span class="user-status">✓ Logged in as {{ user.full_name }}</span>
                <a href="/logout/">Logout</a>
            {% else %}
                <span class="user-status">Not logged in</span>
                <a href="/login/">Login</a>
                <a href="/register/">Register</a>
            {% endif %}
        </div>
        <h1>AirSense</h1>
        <p>Weather & Pollen Tracker</p>
        
        <div class="weather-section">
            <h2>Weather Forecast</h2>
            
            <div id="currentCityName"></div>
            
            <div class="current-weather">
                <div id="current-temp">--°C</div>
                <div id="current-condition">Loading...</div>
                <div id="current-humidity">Humidity: --%</div>
            </div>
            
            <div class="day-selector">
                <div class="day-bar" id="dayBar"></div>
            </div>
            
            <div class="daily-weather">
                <div id="daily-temp">Max: --°C | Min: --°C</div>
                <div id="daily-condition">--</div>
            </div>
            
            <div class="hourly-weather">
                <h3>Hourly Forecast</h3>
                <table id="hourly-table">
                    <thead>
                        <tr>
                            <th>Hour</th>
                            <th>Temperature</th>
                            <th>Condition</th>
                        </tr>
                    </thead>
                    <tbody id="hourly-container"></tbody>
                </table>
            </div>
        </div>
        
        <div class="pollen-forecast-section">
            <h2>Pollen Forecast</h2>
            
            <div class="pollen-controls">
                <input type="date" id="pollenDateSelect">
                <div class="pollen-day-bar" id="pollenDayBar"></div>
            </div>
            
            <div class="hourly-pollen">
                <h3>Hourly Pollen Forecast</h3>
                <table id="pollen-hourly-table">
                    <thead>
                        <tr>
                            <th>Hour</th>
                            <th>Alder</th>
                            <th>Birch</th>
                            <th>Grass</th>
                            <th>Mugwort</th>
                            <th>Olive</th>
                            <th>Ragweed</th>
                        </tr>
                    </thead>
                    <tbody id="pollen-hourly-container"></tbody>
                </table>
            </div>
        </div>
        
        <div class="pollen-section">
            <h2>Pollen Allergies</h2>
            <form id="pollenForm">
                <div class="pollen-checkboxes">
                    <label><input type="checkbox" name="pollens" value="alder" {% if 'alder' in user_allergies %}checked{% endif %}> Alder Pollen</label>
                    <label><input type="checkbox" name="pollens" value="birch" {% if 'birch' in user_allergies %}checked{% endif %}> Birch Pollen</label>
                    <label><input type="checkbox" name="pollens" value="grass" {% if 'grass' in user_allergies %}checked{% endif %}> Grass Pollen</label>
                    <label><input type="checkbox" name="pollens" value="mugwort" {% if 'mugwort' in user_allergies %}checked{% endif %}> Mugwort Pollen</label>
                    <label><input type="checkbox" name="pollens" value="olive" {% if 'olive' in user_allergies %}checked{% endif %}> Olive Pollen</label>
                    <label><input type="checkbox" name="pollens" value="ragweed" {% if 'ragweed' in user_allergies %}checked{% endif %}> Ragweed Pollen</label>
                </div>
            </form>
        </div>
        
        <div class="feeling-section">
            <h2>How do you feel today?</h2>
            <form id="feelingForm">
                {% csrf_token %}
                <textarea id="feelingText" placeholder="Describe how you feel today..."></textarea>
                <button type="submit">Analyze</button>
            </form>
            <div id="sentimentResult"></div>
        </div>
    </div>
    
    <script>
        const weatherData = {{ weather_data|safe }};
        const pollenData = {{ pollen_data|safe }};
        const userAuthenticated = {{ user.is_authenticated|yesno:"true,false" }};
    </script>
    <script src="/static/core/js/home.js"></script>
</body>
</html>